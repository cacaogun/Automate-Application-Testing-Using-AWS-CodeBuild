# Automate-Application-Testing-Using-AWS-CodeBuild

Automated testing into your DevOps pipelines is crucial to increase speed and efficiency by ensuring that your application functions properly after every update. 
Enforcing adequate test coverage will make sure that your entire application works. When you fix one area you will know if you have accidentally broken another. 
Finally, all of these tests are more efficient if your Developers have useful reporting to show where they need to troubleshoot any potential failures.
This project demonstrates how I use AWS CodeBuild as a part of Continuous Integration pipelines to test and build code. Test techniques included:
•	Functional unit tests
•	Isolated component tests with mocked dependencies


I cloned a mini tic-tac-toe react application. The manual process of fixing bugs creates problems with updates and patches. As the requirement is moving to an automated infrastructure-as-code style of deployment for any new applications. I want to install as many workloads as possible on scalable, ephemeral, environments. This requires the creation of deployments that are repeatable and do not require manual changes after installation. If an application has issues, I can replace the problem component. And the most important, each deployment package must be tested for bugs before being deployed. When issues are found, a new version will have to be released to address the issues in a new deployment without manual intervention. Technologies used:
-	AWS CodePipeline for automation and AWS CodeBuild to build the code. After a successful build, the deployment package is uploaded to Amazon S3
-	Cloud9 IDE because it is accessible from anywhere in the world, from any compatible device, via remote access.

**SAMPLE APP:**

![image](https://github.com/cacaogun/Automate-Application-Testing-Using-AWS-CodeBuild/assets/103553102/aa6aae8b-5d51-4a5a-8030-39479f487eee)

**Add Testing in my Build**

The biggest issue is that there are no tests run during the build process. To make sure that my code builds complete as quickly as possible, so I want to run the test command before running the build command.
Add the following command as the first command in the list of commands in the build phase.

- ``npm run test:ci -- --coverage``
- 
![image](https://github.com/cacaogun/Automate-Application-Testing-Using-AWS-CodeBuild/assets/103553102/aa9dba39-29b7-4b1e-a994-be9e35d14bf6)

**INSTRUCT CODEBUILD TO EXPORT THE BUILD REPORTS GENERATED BY MY FRAMEWORK**

With the change I just made, the build will only succeed if the application tests pass. The test results and failures are not as visible or easy to interpret as they can be yet. To increase visibility and clarity, CodeBuild has support to display test and coverage reports exported by frameworks. Test frameworks have been configured to create both types of reports that will export. At the end of the buildspec file, add the following reports section and save it.

reports:

  web-application:
  
    files:
    
      - "clover.xml"
      
    base-directory: "react-app/coverage"
    
    discard-paths: yes
    
    file-format: CLOVERXML
    
  web-application-tests:
  
    files:
    
      - "junit.xml"
      
    base-directory: "react-app"
    
    discard-paths: yes
    
    file-format: JUNITXML
    
Then commit changes locally and push them to the shared AWS CodeCommit repository.

**DETERMINE WHERE YOUR BUILD IS FAILING**

Wait until the pipeline finishes.
You will see that the pipeline is now failing on the Build Stage.

![image](https://github.com/cacaogun/Automate-Application-Testing-Using-AWS-CodeBuild/assets/103553102/f5d6fc18-131f-4bb3-ada4-20bb06931407)

Get back to the Cloud9 Terminal. We could see that two tests failed and seven tests passed. In the Test cases section, you see each test that was run

![image](https://github.com/cacaogun/Automate-Application-Testing-Using-AWS-CodeBuild/assets/103553102/94df2f12-7f85-4a44-b8d8-0311360791d7)
![image](https://github.com/cacaogun/Automate-Application-Testing-Using-AWS-CodeBuild/assets/103553102/4a225c06-7450-4b62-b2c3-ea03860a96a3)

**Fix error: GameBoard.test.js the game can be won by X**
On line 17 of the GameBoard.test.js, there is an array of possible winning combinations, it appears that the combination being tested, [0,3,6], is not there. Add these codes:

wins = [

  [0, 1, 2],
  
  [3, 4, 5],
  
  [6, 7, 8],
  
  [1, 4, 7],
  
  [2, 5, 8],
  
  [0, 4, 8],
  
  [2, 4, 6],
  
  [0, 3, 6],
  
];

**Fix error: PageHeader.test.js confirm that the header renders**
This test is looking for the text “Tic-Tac-Toe!” in the header, but the actual text in the header doesn’t have an exclamation mark on it. You will have to check with the marketing department to see which title is correct.
This file instructs the test runner what to do to test your application. It starts by importing the testing libraries, GameBoard component, and creates a variable that is used when looping through all buttons

![image](https://github.com/cacaogun/Automate-Application-Testing-Using-AWS-CodeBuild/assets/103553102/88f59e33-14b0-4a9f-9f11-bea382c0695e)

And walla! All the tests are passed now! I could commit and push code to the shared repository.Watch the pipeline run …and fail again on the Build Stage.

![image](https://github.com/cacaogun/Automate-Application-Testing-Using-AWS-CodeBuild/assets/103553102/05b31804-03ff-4c78-a48e-50e07b1efa74)

can see that the build failed because of a COMMAND_EXECUTION_ERROR, it was an error executing the command that that instructed npm to test code in the CI environment, again. If you roll up, you can see that all tests pass. Unfortunately, right after the table, it informs I am not testing enough of the code. The coverage threshold for lines is 100%, mine at 95.56%.

**Create Tests to Cover all Lines of Code**

The line coverage threshold is a configuration setting of testing framework. The test command failed since it didn’t match the threshold configured, causing the build job to fail. 
I am going to create a test for the remaining file in the application. To get instant feedback on the changes made, open the Jest test runner with the npm test command.

Jest looks for test files that end with .test.js. You will create your new test file in the src directory following the naming convention that was established by the existing tests.
I created App.test.js and paste the following code into it and save the file.

import { render, screen } from "@testing-library/react";

import App from "./App";


describe("App.test.js", () => {

  test("renders App component", () => {
  
    render(<App />);

  });
  
});


That will cause the test runner to run your test and it will pass. This test just renders the App component. This works, and would actually give you 100% test coverage, but the scope of this test is too broad.

Since App.js renders sub-components, you want to make sure that a failure in one of those doesn’t cause the parent test to fail. To handle this we will mock the sub-components. With the introduction of mocking, we are able to just do component testing and not integration testing. If the interaction between components is important, you can always create another test file that doesn’t use mocking.

In the App.test.js file, after line 4, paste the following code.

jest.mock("./GameBoard", () => {

  return function GameBoard(props) {
  
    return <div data-testid="GameBoard">Gameboard</div>;
    
  };
  
});

jest.mock("./SupportInfo", () => {

  return function SupportInfo(props) {
  
    return <div data-testid="SupportInfo">SupportInfo</div>;
    
  };
  
});

jest.mock("./PageHeader", () => {

  return function PageHeader(props) {
  
    return <div data-testid="PageHeader">PageHeader</div>;
    
  };
  
});


The jest.mock will essentially intercept the calls to import those 3 modules and return the simple function included in the mock call instead of the contents of the requested files. For instance, instead of the test rendering the entire GameBoard, it only renders a div component with the text GameBoard in it.

Commit and push code to the shared repository. 
Check again the CodePipeline

![image](https://github.com/cacaogun/Automate-Application-Testing-Using-AWS-CodeBuild/assets/103553102/60f1aefc-e031-40b9-b8a4-2f187a86fc72)

Succeed! View the reports to confirm new tests and 100% code coverage.

**Conclusion**
 I just have an automated build pipeline for your web application code. The pipeline not only publishes the application bundle to be deployed, it only publishes it if your code works as expected.
This project could help me to configure CodeBuild to perform application testing, troubleshoot and fix CI/CD pipeline failures, review CodeBuild reports and logs, apply common code testing strategies, describe the importance of robust test coverage

